Titre: On Transaction Fees, And The Fallacy of Market-Based Solutions\nAuteur: Vitalik Buterin\nDate: February 1, 2014\nURL: https://blog.ethereum.org/2014/02/01/on-transaction-fees-and-the-fallacy-of-market-based-solutions\nCatégorie: Non catégorisé\n\n==================================================\n\nf all the parts of the thereum protocol, aside from the mining function the fee structure is perhaps the least set in stone. he current values, with one crypto operation taking  base fees, a new transaction taking  base fees, etc, are little more than semi-educated guesses, and harder data on eactly how much computational power a database read, an arithmetic operation and a hash actually take will certainly give us much better estimates on what eactly the ratios between the different computational fees should be. he other part of the question, that of eactly how much the base fee should be, is even more difficult to figure out we have still not decided whether we want to target a certain block size, a certain -denominated level, or some combination of these factors, and it is very difficulty to say whether a base fee ofnn.nnonnrnnannbnnannsnnennfnnennennonnfnn. or a base fee ofnn.nnornnabannsennfnneeonnfnn. would be more appropriate. ltimately, what is becoming more and more clear to us is that some kind of fleible fee system, that allows consensus-based human intervention after the fact, would be best for the project.nnhen many people coming from itcoin see this problem, however, they wonder why we are having such a hard time with this issue when itcoin already has a ready-made solution make the fees voluntary and market-based. n the itcoin protocol, there are no mandatory transaction fees even an etremely large and computationally arduous transaction can get in with a zero fee, and it is up to the miners to determine what fees they require. he lower a transaction’s fee, the longer it takes for the transaction to find a miner that will let it in, and those who want faster confirmations can pay more. t some point, an equilibrium should be reached. roblem solved. o why not herennhe reality, is, however, is that in itcoin the transaction fee problem is very far from “solved”. he system as described above already has a serious vulnerability miners have to pay no fees, so a miner can choke the entire network with an etremely large block. n fact, this problem is so serious that atoshi close to fi it with the ugliest possible path set a maimum block size limit of  , or  transactions per second. ow, without the immensely hard-fought and politically laden debate that necessarily accompanies any “hard-forking” protocol change, itcoin simply cannot organically adapt to handle anything more than the  t/sec limit that atoshi originally placed.nnnd that’s itcoin. n thereum, the issue is even more problematic due to uring-completeness. n itcoin, one can construct a mathematical proof that a transaction  bytes long will not take more than k* time to verify for some constant k. n thereum, one can construct a transaction in less than  bytes that, absent fees, will run forevernn , ,  , ,  ], v, r, s ]nnn case you do not understand that, it’s the equivalent of  _,    an infinite loop. nd as soon as a miner publishes a block that includes that transaction, the entire network will freeze. n fact, thanks to the well-known impossibility of thennhalting problemnn,nnit is not even possible to construct a filter to weed out infinite-looping scriptsnn.nnhus, computational attacks on thereum are trivial, and even more restrictions must be placed in order to ensure that thereum remains a workable platform. ut wait, you might say, why not just take the   limit, and convert it into ann million  base fee limitnn ne can even make the system more future-proof by replacing a hard cap with a floating cap of  times the moving average of the last  blocks. t this point, we need to get deeper into the economics and try to understand what “market-based fees” are all about.nnrypto, eet igounnn general terms, an idealized market, or at least one specific subset of a market, can be defined as follows. here eist a set of sellers, ] ... n], who are interested in selling a particular resource, and where seller i] incurs a cost ci] from giving up that resource. e can say c]  c]  ...  cn] for simplicity. imilarly, there eist some buyers, ] ... n], who are interested in gaining a particular resource and incur a gain gi], where g]  g]  ...  gn]. hen, an order matching process happens as follows. irst, one locates the last k where gk]  ck]. hen, one picks a price between those two values, say at p  (gk] + ck])/, and i] and i] make a trade, where i] gives the resource to i] and i] pays p to i]. ll parties benefit, and the benefit is the maimum possible if k+] and k+] also made a transaction, ck+]  vk+], so the transaction would actually have negative net value to society. ortunately, it is in everybody’s interest to make sure that they do not participate in unfavorable trades.nnhe question is, is this kind of market the right model for itcoin transactions o answer this question, let us try to put all of the players into roles. he resource is the service of transaction processing, and the people benefitting from the resource, the transaction senders, are also the buyers paying transaction fees. o far, so good. he sellers are obvious the miners. ut who is incurring the costs ere, things get tricky. or each individual transaction that a miner includes, the costs are borne not just by that miner, but by every single node in the entire network. he cost per transaction is tiny a miner can process a transaction and include it in a block for less thannn.nnwnnonnrnntnnhnnonnfnnennlnnenncnntnnrnninncnninntnnynnannnnndnndnnanntnnannsnntnnonnrnnanngnnenn.nnnnhnnennrnnennannsnnonnnnnwnnhnnynntnnrnnannnnnsnnanncnntnninnonnnnnfnnennennsnnnnnennenndnntnnonnbnnennhnninngnnhnninnsnnbnnenncnnannunnsnnenntnnhnnanntnn. worth of electricity and data storage. he reason why transaction fees need to be high is because thatnn.nnwnnornntnnhnnonnfnnennlnnecnntnnrnninncnninntnnynnannnddnnanntnnannsnntnnornnanngnnenn.nnnnhnnerennannsonnnnnwnnhnnynntnnrnnannnsnnanncnntnninnonnnnnfnneesnnnnneenndnntnnonnbnnennhinngnnhinnsnnbnnecnnannunnsenntnnhanntnn. is being paid by thousands of nodes all around the world.nnt gets worse. uppose that the net cost to the network of processing a transaction is close tonn..nnnnnnntnnhnnennonnrnnynn,nnennvnnennnnninnfnntnnhnnenncnnonnsnntnnsnnannrnnennnnnonntnnbnnonnrnnnnnennbnnynnennnnanncnntnnlnnynntnnhnnennsnnannmnnennpnnennonnpnnlnnennwnnhnnonnsnnenntnntnnhnnennpnnrnninncnnennsnn,nnannsnnlnnonnnnngnnannsnntnnhnnenntnnrnnannnnnsnnanncnntnninnonnnnnfnnennenninnsnncnnlnnonnsnnenntnnonn.. n theory, even if the costs are not borne by eactly the same people who set the prices, as long as the transaction fee is close tonn..nnnnnnntnnhnneorynn,nnennvnnennninnfnntnnhnnecosnntnnsnnannrennnnnonntnnbnnornnnnnennbnnyennnnanncnntlnnynntnnhnnesnnamnnennpnneonnplnnennwnnhnnosennttnnhnnennpnnrnninncesnn,nnannsnnlnnonnnnngnnannsnntnnhnnenntnnrnnannnsnnanncnntnninnonnnnnfnneenninnscnnlnnosenntnnonn. the system would still be in balance. ut what is the equilibrium transaction fee going to be ight now, fees are aroundnn.nnsnninnmnnpnnlnnynnbnnenncnnannunnsnnennmnninnnnnennrnnsnnannrnnenntnnonnonnlnnannznnynntnnonnsnnwnninntnncnnhnn.nnnnunntnntnnhnnennnnn,nninnnnntnnhnnennfnnunntnnunnrnnenn,nnwnnhnnanntnnhnnannpnnpnnennnnnsnnonnnnncnnennfnnennennsnnbnnenncnnonnmnnennannlnnannrnngnnennrnnsnnhnnannrnnennonnfnnannmnninnnnnennrnn’nnsnnrnnennvnnennnnnunnennannnnndnnmnninnnnnennrnnsnnhnnannvnnennannlnnannrnngnnenninnnnncnnennnnntnninnvnnenntnnonntnnrnnynntnnonnmnnannnninnmnninnznnenntnnhnnenninnrnntnnannknnennnnnnhnnennonnbnnvnninnonnunnsnnannnnnsnnwnnennrnninnsnn,nnfnnonnrnnannsnnonnlnnonnmnninnnnnennrnntnnhnnennennqnnunninnlnninnbnnrnninnunnmnntnnrnnannnnnsnnanncnntnninnonnnnnfnnennenninnsnn. simply because miners are too lazy to switch. ut then, in the future, what happens once fees become a larger share of a miner’s revenue and miners have a large incentive to try to maimize their take he obvious answer is, for a solo miner the equilibrium transaction fee isnn.nnsnnimnnplnnynnbnnecnnannunnsennminnnersnnannrenntnnoonnlnnannzynntnnosnnwnninntnncnnhnn.nnnnunnttnnhnnennnnn,nninnntnnhnnennfnnunntnnunnrenn,nnwnnhanntnnhannppnnennnnnsonnnnncennfnneesnnbnneconnmnnennannlnnannrnngnnersnnhannreonnfnnaminnnernn’nnsrennvnnennnnnunnennannndnnminnnersnnhannvnnennannlnnannrnngnnenninnncennnnntnninnvnnenntnnonntnnrynntnnonnmannnniminnzenntnnhnnenninnrnntnnaknnennnnnnhnneonnbnnvnninnonnunnsnnannnsnnwnnernninnsnn,nnfnnornnannsonnlnnonnminnnernntnnhnneennqnnunninnlnnibnnrnninnunnmnntnnrnnannnsnnanncnntnninnonnnnnfnneenninnsnn.. f a transaction with a fee ofnn.nncnnonnmnnennsnninnnnn,nnannnnndnntnnhnnennmnninnnnnennrnnanndnndnnsnninntnn,nntnnhnnennmnninnnnnennrnnwnninnlnnlnnhnnannvnnennennannrnnnnnenndnnannpnnrnnonnfnninntnnonnfnn. comes in, and the miner adds it, the miner will have earned a profit ofnn.nnconnmnnesnninnn,nnannndnntnnhnnennminnnernnannddnnsnninntnn,nntnnhnnennminnnernnwnninnllnnhannvnneennannrnnnnnenndnnannpnnronnfnninntnnonnfnn., and the remaining $. worth of costs will be paid by the rest of the network together – a cryptographic tragedy of the commons.nnow, suppose that the mining ecosystem is more oligarchic, with one pool controlling % of all mining power. hat are the incentives then ere, it gets more tricky. he mining pool can actually choose to set its minimum fee higher, perhaps atnn..nnnnhnninnsnnmnnannynnsnnennennmnnlnninnknnenntnnhnnennpnnonnonnlnninnsnnfnnonnrnngnnonninnnnngnnpnnrnnonnfnninntnnonnpnnpnnonnrnntnnunnnnninntnninnennsnnbnnenntnnwnnennennnnn.. his may seem like the pool is forgoing profit opportunities betweennn..nnnnhinnsnnmannyseennmnnlnniknnenntnnhnnennpnnoonnlnninnsnnfnnornngnnonninnngnnpnnronnfnninntnnonnppnnornntnnunnninntnninnesnnbnnenntwnneennnnn. andnn.nn,nnbnnunntnnwnnhnnanntnninnsnnannlnnsnnonnhnnannpnnpnnennnnninnnnngnninnsnntnnhnnanntnnmnnannnnnynnonnfnntnnhnnenntnnrnnannnnnsnnanncnntnninnonnnnnsnnennnnndnnennrnnsnnwnnhnnonnwnnennrnnennanndnndnninnnnngnnbnnenntnnwnnennennnnn., but what is also happening is that many of the transaction senders who were adding betweennn.nn,nnbnnunntwnnhanntnninnsnnannlnnsonnhannppnnennninnngnninnsnntnnhanntnnmannnyonnfnntnnhnnenntnnrnnannnsnnanncnntnninnonnnnnsennnnndnnersnnwnnhnnonnwnnerennannddnninnngnnbnnenntwnneennnnn. and $. before now have the incentive to increase their fees to make sure this pool confirms their transactions – otherwise, they would need to wait an average of . minutes longer. hus, the fewer miners there are, the higher fees go – even thought a reduced number of miners actually means a lower network cost of processing all transactions.nnrom the above discussion, what should become painfully clear is that transaction processing simplynnis not a marketnn, and therefore trying to apply market-like mechanisms to it is an eercise in random guessing at best, and a scalability disaster at worst. o what are the alternatives he economically ideal solution is one that has often been brought up in the contet of global warming, perhaps the largest geopolitical tragedy of the commons scenario in the modern worldnnigovian taesnn.nnrice etting without  arketnnhe way a igovian ta works is simple. hrough some mechanism, the total net cost of consuming a certain quantity of a common resource (eg. network computation, air purity) is calculated. hen, everyone who consumes that resource is required to pay that cost for every unit of the resource that they consume (or for every unit of pollution that they emit). he challenge in igovian taation, however, is twofold. irst, who gets the revenue econd, and more importantly, there is no way to opt out of pollution, and thus no way for the market to etract people’s preferences about how much they would need to gain in order to suffer a given dose of pollution thus, how do we set the pricennn general, there are three ways of solving this problemnnhilosopher kings set the price, and disappear as the price is set in stone forever.nnhilosopher kings maintain active control over the price.nnome kind of democratic mechanismnnhere is also a fourth way, some kind of market mechanism which randomly doles out etra pollution to certain groups and attempts to measure the etent to which people (or network nodes in the contet of a crytocurrency) are willing to go to avoid that pollution this approach is interesting but heavily undereplored, and  will not attempt to eamine it at this point in time.nnur initial strategy was (). ipple’s strategy is (). ow, we are increasingly looking to (). ut how would () be implemented ortunately, cryptocurrency is all about democratic consensus, and every cryptocurrency already has at least two forms of consensus baked in proof of work and proof of stake.  will show two very simple protocols for doing this right nownnroof of work rotocolnnf you mine a block, you have the right to set a value in the “etra data field”, which can be anywhere from - bytes (this is already in the protocol)nnf the first byte of this data is , nothing happensnnf the first byte of this data is , we set block.basefee  block.basefee + floor(block.basefee / )nnf the first byte of this data is , we set block.basefee  block.basefee - floor(block.basefee / )nnroof of stake rotocolnnfter each block, calculate h  sha(block.parenthash + address) * block.address_balance(address)for each addressnnf h  ^ / difficulty, where difficulty is a set constant, that address can sign either ,  or  and create a signed object of the form  val, v, r, s ]nnhe miner can then include that object in the block header, giving the miner and the stakeholder some miniscule reward.nnf the data is , we set block.basefee  block.basefee + floor(block.basefee / )nnf the data is , we set block.basefee  block.basefee - floor(block.basefee / )nnhe two protocols are functionally close to identical the only difference is that in the proof of work protocol miners decide on the basefee and in the proof of stake protocol ether holders do. he question is, do miners and ether holders have their incentives aligned to set the fee fairly f transaction fees go to miners, then miners clearly do not. owever, if transaction fees are burned, and thus their value goes to all ether holder proportionately through reduced inflation, then perhaps they do. iners and ether holders both want to see the value of their ether go up, so they want to set a fee that makes the network more useful, both in terms of not making it prohibitively epensive to make transactions and in terms of not setting a high computational load. hus, in theory, assuming rational actors, we will have fees that are at least somewhat reasonable.nns there a reason to go one way or the other in terms of miners versus ether holders erhaps there is. iners have the incentive to see the value of ether go as high as possible in the short term, but perhaps not so much in the long term, since a prolonged rise eventually brings competition which cancels out the miners’ increased profit. hus, miners might end up adopting a looser policy that imposes higher costs (eg. data storage) on miners far down the line. ther holders, on the other hand, seem to have a longer term interest. n the other hand, miners are somewhat “locked in” to mining ether specifically, especially if semi-specialized or specialized hardware gets involved ether holders, on the other hand, can easily hop from one market to the other. urthermore, miners are less anonymous than ether holders. hus, the issue is not clear cut if transaction fees are burned one can go either way.